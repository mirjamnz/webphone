<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebRTC Call Center</title>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="app-container">
    
    <div class="panel sidebar">
        
        <div class="sidebar-header">
            <h3><i class="fa-solid fa-headset"></i> Agent Panel</h3>
            <button class="config-btn" id="btnShowConfig" title="Settings">
                <i class="fa-solid fa-gear"></i>
            </button>
        </div>

        <div class="status-card">
            <div>
                <span id="statusDot" class="status-indicator"></span>
                <span id="statusText" style="font-size: 0.9rem; color: var(--text-muted)">Offline</span>
            </div>
            <button id="btnLogin" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.8rem;">
                <i class="fa-solid fa-power-off"></i> <span id="loginBtnText">Login</span>
            </button>
        </div>

        <input type="text" id="dialString" placeholder="Enter Number..." autocomplete="off">

        <div class="dial-pad">
            <button class="digit-btn" data-digit="1">1</button>
            <button class="digit-btn" data-digit="2">2</button>
            <button class="digit-btn" data-digit="3">3</button>
            <button class="digit-btn" data-digit="4">4</button>
            <button class="digit-btn" data-digit="5">5</button>
            <button class="digit-btn" data-digit="6">6</button>
            <button class="digit-btn" data-digit="7">7</button>
            <button class="digit-btn" data-digit="8">8</button>
            <button class="digit-btn" data-digit="9">9</button>
            <button class="digit-btn" data-digit="*">*</button>
            <button class="digit-btn" data-digit="0">0</button>
            <button class="digit-btn" data-digit="#">#</button>
        </div>

        <div class="action-grid">
            <button id="btnCall" class="btn btn-success" style="grid-column: span 2">
                <i class="fa-solid fa-phone"></i> Call
            </button>
            <button class="btn btn-warning" onclick="app.callSpecial('*45')"> <i class="fa-solid fa-right-to-bracket"></i> Q-In
            </button>
            <button class="btn btn-danger" onclick="app.callSpecial('*46')"> <i class="fa-solid fa-right-from-bracket"></i> Q-Out
            </button>
        </div>

        <div id="configModal" class="modal-overlay hidden">
            <div class="sidebar-header" style="border:none;">
                <h3>Configuration</h3>
                <button class="config-btn" id="btnCloseConfig"><i class="fa-solid fa-xmark"></i></button>
            </div>
            
            <div class="config-scroll-area">
                <div class="config-group">
                    <label>Extension / Username</label>
                    <input type="text" id="cfgUser">
                </div>
                <div class="config-group">
                    <label>Password</label>
                    <input type="password" id="cfgPass">
                </div>
                <div class="config-group">
                    <label>Domain</label>
                    <input type="text" id="cfgDomain">
                </div>
                <div class="config-group">
                    <label>WSS Server URL</label>
                    <input type="text" id="cfgWss">
                </div>

                <hr style="border-color: var(--border); margin: 15px 0;">

                <div class="config-group">
                    <label><i class="fa-solid fa-microphone"></i> Microphone</label>
                    <select id="cfgMic" class="select-input"></select>
                </div>
                <div class="config-group">
                    <label><i class="fa-solid fa-volume-high"></i> Speaker (Call Audio)</label>
                    <select id="cfgSpeaker" class="select-input"></select>
                </div>
                <div class="config-group">
                    <label><i class="fa-solid fa-bell"></i> Ringing Output</label>
                    <select id="cfgRinging" class="select-input"></select>
                </div>
            </div>

            <button id="btnSaveConfig" class="btn btn-primary" style="margin-top: auto;">
                Save & Reconnect
            </button>
        </div>
    </div>

    <div class="panel main-stage">
        
        <div id="idleState" class="call-info">
            <i class="fa-solid fa-phone-volume" style="font-size: 4rem; color: var(--border); margin-bottom: 20px;"></i>
            <h2 style="color: var(--text-muted)">Ready for calls</h2>
        </div>

        <div id="activeState" class="call-info hidden">
            <div class="avatar-circle">
                <i class="fa-solid fa-user"></i>
            </div>
            <h2 id="remoteIdentity">Unknown</h2>
            <div id="callTimer" class="timer">00:00</div>
            <div style="margin-top: 10px; color: var(--success); font-size: 0.9rem;">
                <i class="fa-solid fa-shield-halved"></i> Audio Only (Opus/Alaw)
            </div>
        </div>

        <div id="incomingModal" class="incoming-overlay hidden">
            <div class="incoming-box">
                <div class="avatar-circle pulsing">
                    <i class="fa-solid fa-phone"></i>
                </div>
                <h3>Incoming Call</h3>
                <p id="incomingIdentity">Unknown</p>
                <div class="incoming-actions">
                    <button id="btnReject" class="btn btn-danger btn-circle"><i class="fa-solid fa-phone-slash"></i></button>
                    <button id="btnAnswer" class="btn btn-success btn-circle"><i class="fa-solid fa-phone"></i></button>
                </div>
            </div>
        </div>

        <audio id="remoteAudio" autoplay></audio>

        <div id="controlsBar" class="controls-bar">
            <button id="btnMute" class="ctrl-btn mute" title="Mute">
                <i class="fa-solid fa-microphone-slash"></i>
            </button>
            
            <button id="btnHangup" class="ctrl-btn hangup" title="End Call">
                <i class="fa-solid fa-phone-slash"></i>
            </button>
            
            <button id="btnHold" class="ctrl-btn hold" title="Hold">
                <i class="fa-solid fa-pause"></i>
            </button>
        </div>
    </div>

</div>

<script type="module" src="js/app.js"></script>

</body>
</html>